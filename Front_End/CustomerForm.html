<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CustomerForm</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="assets/css/bootstrap.min.css" rel="stylesheet">

</head>
<body style="width: 1524px">
<header>
  <!--  //logo-->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img src="../Assets/dKP.png" alt="Logo" width="30" height="24" class="d-inline-block align-text-top">
        Dkp-Product  </a>
    </div>

    <!--/links-->
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Navbar</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>


      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a href="../DashBord.html" class="nav-link active" aria-current="page" href="#">Home</a>
          <a class="nav-link active" aria-current="page" href="#">Orders</a>
          <a class="nav-link active" aria-current="page" href="#">Items</a>
          <a class="nav-link active" aria-current="page" href="#">Customers</a>

        </div>
      </div>
      <!--  Search-->
    </div>

    <div class="container-fluid">
      <form class="d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success" type="submit">Search</button>
      </form>
    </div>
  </nav>
</header>


<main>
  <section>
    <h1 class="bg-success p-2 text-white bg-opacity-75">Customer Details</h1>
  </section>
  <br>
  <section>
    <!-- Button trigger modal -->
    <button  type="button" class="btn btn-primary bg-danger float-end" data-bs-toggle="modal" data-bs-target="#exampleModal">
      Add New Customer
    </button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Add New Customers</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col">
                <input type="text" class="form-control" placeholder="ID" aria-label="ID">
              </div>
              <div class="col">
                <input type="text" class="form-control" placeholder="Name" aria-label="Name">
              </div>
            </div>
            <br>
            <br>
            <div class="row">
              <div class="col">
                <input type="text" class="form-control" placeholder="ContNo" aria-label="ContNo">
              </div>
              <div class="col">
                <input type="text" class="form-control" placeholder="Address" aria-label="Address">
              </div>

            </div>

            <br>




          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary"  >Save</button>
          </div>
        </div>
      </div>
    </div>

  </section>
  <br>

  <section>
    <form id="customerForm">

    <div class="row">
      <div class="col">
        <label for="txtCustomerID">Customer ID</label>

        <input type="text" id="txtCustomerID"  class="form-control d-inline-block" placeholder="C001" aria-label="ID">
      </div>
      <div class="col">
        <label for="txtCustomerName">Customer Name</label>

        <input type="text" id="txtCustomerName" class="form-control d-inline-block" placeholder="Kamal" aria-label="Name">
      </div>
    </div>

    <br>
    <div class="row">
      <div class="col">
        <label for="txtCustomerContNo">Customer ContNO</label>

        <input type="number" id="txtCustomerContNo" class="form-control" placeholder="+940771530632" aria-label="ContNo">
      </div>
      <div class="col">
        <label for="txtCustomerAddress">Customer Address</label>

        <input type="text" class="form-control" id="txtCustomerAddress" placeholder="Galle" aria-label="Address">
      </div>


      <div class="col">
        <label for="txtCustomerSalary">Customer Salary</label>

        <input type="number" class="form-control" id="txtCustomerSalary" placeholder="20000.00" aria-label="Salary">
      </div>

    </div>
    </form>
    <br><br>
    <button type="button" id="SaveCustomer" class="btn btn-primary">Save</button>
    <button type="button" class="btn btn-secondary">Remove</button>
    <button type="button" class="btn btn-success">Update</button>
    <button type="button" class="btn btn-danger">Delete</button>
    <button type="button" class="btn btn-warning">Clearall</button>
    <button type="button" id="LoadAllCustomer" class="btn btn-info">getall</button>
  </section>
  <br>
  <br>
  <section>
    <table  style="width: 95%" border="2px solid red"   class="col table table-bordered border-primary table-dark table-striped">
      <thead>
      <tr class="table-dark table-striped">
        <th scope="col">Id</th>
        <th scope="col">Name</th>
        <th scope="col">ContNo</th>
        <th scope="col">Address</th>
        <th scope="col">Salary</th>
      </tr>
      </thead>
      <tbody id="tblCustomer" >
      <tr >
        <td scope="row">1</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>

      </tr>
      <tr>
        <td>2</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>

      </tr>
      <tr>
        <td>3</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>

      </tr>

      </tbody>
    </table>

  </section>
</main>



<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/jquery-3.6.1.min.js"></script>


<script>



  //  //validation Part eka regular expreshan walin
  //var CusIdRegEx = /^(C)[0-9]{1,3}$/
  //
  //  //make Array for validation
  //  var CusValidation = [];
  //  //Add data to validation Arrray
  //  //mekata data danne object vidiyata
  //  CusValidation.push({
  //    reg:CusIdRegEx,
  //    field : $("#txtCustomerID"),
  //    error : 'Customer id Paten Is Wrong'
  //  })
  //
  //



  let baseURL="http://localhost:8080/Back_End_war/";



  $("#SaveCustomer").click(function (){
    var formData = $("#customerForm").serialize();

    $.ajax({
      url:baseURL+"customer",
      method:"post",
      data:formData,
      dataType:"json",

      success:function (res){
        alert(res.message);
        loadAllCustomerDetails();
      },
      error:function (error){
        var jsObject = JSON.parse(error.responseText);
      alert(jsObject.message)
      }
    });
  });

  $("#LoadAllCustomer").click(function (){
    loadAllCustomerDetails()
    EventBinding();
  });

  //Enter Button use for textfield
  $("#txtCustomerID").on('keydown',function (event){

    if (event.key == "Enter"){
      $("#txtCustomerName").focus();
    }

  });

  $("#txtCustomerName").on('keydown',function (event){

    if (event.key == "Enter"){
      $("#txtCustomerContNo").focus();
    }

  });

  $("#txtCustomerContNo").on('keydown',function (event){

    if (event.key == "Enter"){
      $("#txtCustomerAddress").focus();
    }

  });

  $("#txtCustomerAddress").on('keydown',function (event){

    if (event.key == "Enter"){
      $("#txtCustomerSalary").focus();
    }

  });

  $("#txtCustomerSalary").on('keydown',function (event){

    if (event.key == "Enter"){
      confirm("Do You Want To Add This Customer...?")
      $("#SaveCustomer").focus();
    }

  });

  // Tap Button Remove
  $("#txtCustomerID,#txtCustomerName,#txtCustomerContNo,#txtCustomerAddress,#txtCustomerSalary").on('keydown' , function (event){

    if (event.key == "Tab"){
      event.preventDefault();
    }
  });


  function loadAllCustomerDetails() {

    // remove all data from the table
    $("#tblCustomer").empty();

    $.ajax({
      url: baseURL + "customer",
      dataType: "json",
      success: function (resp) {
        console.log(resp);

        for (var cus of resp.data) {
          var row = '<tr><td>' + cus.id + '</td><td>' + cus.name + '</td><td>' + cus.address + '</td><td>' + cus.salary + '</td></tr>';
          $("#tblCustomer").append(row);
        }
        EventBinding();

        $("#txtCustomerID").focus();
      }

    });
  }
  function setTextFieldValues(id, name, address, salary) {
    $("#txtCustomerID").val(id);
    $("#txtCustomerName").val(name);
    $("#txtCustomerAddress").val(address);
    $("#txtCustomerSalary").val(salary);
  }



  //  mehidi table eka click karama data print we
  function EventBinding(){
    $("#tblCustomer>tr").click(function (){
      let id = $(this).children(":eq(0)").text();
      let Name = $(this).children(":eq(1)").text();
      let ConNo = $(this).children(":eq(2)").text();
      let Address = $(this).children(":eq(3)").text();
      let Salary = $(this).children(":eq(4)").text();

      //  tble eke textfild walata data add karanawa
      $("#txtCustomerID").val(id);
      $("#txtCustomerName").val(Name);
      $("#txtCustomerAddress").val(Address);
      $("#txtCustomerContNo").val(ConNo);
      $("#txtCustomerSalary").val(Salary);

    });

    //double click remove table colom
    $("#tblCustomer>tr").on('dblclick',function (){
      $(this).remove();
    });

  }



</script>
</body>
</html>